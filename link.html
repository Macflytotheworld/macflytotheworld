<script>
  // ðŸ”— SUBSTITUI AQUI PELO TEU LINK CSV DO GOOGLE SHEETS
  const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTaP8Ts1d3hiug4Xk-Dgi0OiQiSGKfaQo3pbGrk-J0QyBXChHldTNRXG_F4JPzbz58irxEO_USlIngn/pub?gid=0&single=true&output=csv";

  async function fetchLinks() {
    try {
      const res = await fetch(CSV_URL);
      const text = await res.text();
      const rows = text
        .trim()
        .split("\n")
        .map(r => r.split(","));
      
      const header = rows[0].map(h => h.trim());
      const dataRows = rows.slice(1);

      const items = dataRows
        .map(cols => {
          const obj = {};
          header.forEach((key, i) => {
            obj[key] = (cols[i] || "").trim();
          });
          return obj;
        })
        .filter(row => row.affiliate_url && row.active.toLowerCase() !== "false");

      renderLinks(items);
    } catch (err) {
      console.error("Erro a carregar CSV:", err);
    }
  }

  function renderLinks(items) {
    const container = document.getElementById("links");
    if (!items.length) {
      container.innerHTML = "<p style='font-size:13px;color:#9ca3af;text-align:center;'>Sem links ativos neste momento.</p>";
      return;
    }

    items.forEach(item => {
      const a = document.createElement("a");
      a.href = item.affiliate_url;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.className = "card";

      const img = document.createElement("img");
      img.className = "thumb";
      img.src = item.image_url || "https://via.placeholder.com/80x80.png?text=+";
      img.alt = item.title || "Produto";

      const textBox = document.createElement("div");
      textBox.className = "card-text";

      const title = document.createElement("div");
      title.className = "card-title";
      title.textContent = item.title || "Produto";

      const desc = document.createElement("div");
      desc.className = "card-desc";
      desc.textContent = item.description || "";

      textBox.appendChild(title);
      textBox.appendChild(desc);

      const tag = document.createElement("div");
      tag.className = "card-tag";
      tag.textContent = "Produto";

      a.appendChild(img);
      a.appendChild(textBox);
      a.appendChild(tag);

      container.appendChild(a);
    });
  }

  fetchLinks();
</script>
